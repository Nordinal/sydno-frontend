import React, { useEffect, useState } from 'react';
import { Select } from 'antd';
import { TChangeConfigProperty } from '../types';
import { sydnoServiceFormData } from 'SydnoService/service';

export const ExploitationType: React.FC<{
  exploitation_type?: string | null;
  changeConfigProperty: TChangeConfigProperty;
}> = ({
  exploitation_type,
  changeConfigProperty
}) => {
    const [exploitationTypeList, setExploitationTypeList] = useState<{ value: string, label: string }[]>();

    useEffect(() => {
      sydnoServiceFormData.get('/api/selector?exploitationtypes').then(res => {
        const data = res.data.message
        setExploitationTypeList(
          Object.entries(data.exploitation_types as { [x in string]: string })
            .map(([value, label]: [string, string]) => ({
              value,
              label
            }))
        );
      });
    }, []);

    return (
      <>
        <p>Тип эксплуатации</p>
        <Select
          style={{ width: '100%' }}
          value={exploitation_type}
          allowClear
          onChange={(value) => changeConfigProperty<string>('exploitation_type', value)}
          options={exploitationTypeList}
        />
      </>
    )
}
